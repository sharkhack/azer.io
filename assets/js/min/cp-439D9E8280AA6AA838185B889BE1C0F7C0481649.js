function addImage(t){var r=document.createElement("div");r.className="row",r.innerHTML='<div class="cell image" style="padding-right:5px;">  <img /></div><div class="cell color"><div class="palettes"></div></div>';var e=r.querySelector("img");e.src=URL.createObjectURL(t),e.onload=function(){var t=r.querySelector(".palettes");setTimeout(function(){for(var r=getPalette(e,25),n=0;n<r.length;n++){var o=r[n],i="#"+("0"+o[0].toString(16)).slice(-2)+("0"+o[1].toString(16)).slice(-2)+("0"+o[2].toString(16)).slice(-2),u=document.createElement("div");u.setAttribute("style","border:1px dashed #ccc; margin:5px; width:4rem; height:4.3rem; float:left; color:#ccc;");var a=document.createElement("div");a.setAttribute("style","border-bottom:1px dashed #ccc; margin:0px; width:4rem; height:2.7rem; background-color: rgb("+o[0]+", "+o[1]+", "+o[2]+");"),u.appendChild(a);var c=document.createElement("div");c.setAttribute("style","margin:0px; width:4rem; height:1.6rem; text-align:center; padding-top:2px; font-size:12px;"),c.textContent=i,u.appendChild(c),t.appendChild(u)}},0)},document.getElementById("images").appendChild(r)}function getPalette(t,r,e){(void 0===r||r<2||r>256)&&(r=10),(void 0===e||e<1)&&(e=10);var n=document.createElement("canvas"),o=n.getContext("2d"),i=n.width=t.naturalWidth,u=n.height=t.naturalHeight;o.drawImage(t,0,0);for(var a,c,s,h,f=o.getImageData(0,0,i,u).data,l=f.length,p=[],v=0;v<l;v+=e)c=f[(a=4*v)+0],s=f[a+1],h=f[a+2],f[a+3]>=125&&(c>250&&s>250&&h>250||p.push([c,s,h]));var g=MMCQ.quantize(p,r);return g?g.palette():null}function handleImages(t){document.getElementById("images").innerHTML="";for(var r=0;r<t.length;r++)addImage(t[r])}
if(document.ondragover=function(t){t.preventDefault(),t.dataTransfer.dropEffect="copy"},document.ondrop=function(t){t.preventDefault(),handleImages(t.dataTransfer.files)},function(){var t=document.getElementById("upload"),r=document.getElementById("target");t.onchange=function(){handleImages(this.files)},r.onclick=function(){t.click()}}(),Array.prototype.includes||Object.defineProperty(Array.prototype,"includes",{value:function(t,r){if(null==this)throw new TypeError('"this" is null or not defined');var e=Object(this),n=e.length>>>0;if(0===n)return!1;var o,i,u=0|r,a=Math.max(u>=0?u:n-Math.abs(u),0);for(;a<n;){if((o=e[a])===(i=t)||"number"==typeof o&&"number"==typeof i&&isNaN(o)&&isNaN(i))return!0;a++}return!1}}),Object.entries||(Object.entries=function(t){for(var r=Object.keys(t),e=r.length,n=new Array(e);e--;)n[e]=[r[e],t[r[e]]];return n}),Object.keys||(Object.keys=function(){"use strict";var t=Object.prototype.hasOwnProperty,r=!{toString:null}.propertyIsEnumerable("toString"),e=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],n=e.length;return function(o){if("function"!=typeof o&&("object"!=typeof o||null===o))throw new TypeError("Object.keys called on non-object");var i,u,a=[];for(i in o)t.call(o,i)&&a.push(i);if(r)for(u=0;u<n;u++)t.call(o,e[u])&&a.push(e[u]);return a}}()),!pv)var pv={map:function(t,r){var e={};return r?t.map(function(t,n){return e.index=n,r.call(e,t)}):t.slice()},naturalOrder:function(t,r){return t<r?-1:t>r?1:0},sum:function(t,r){var e={};return t.reduce(r?function(t,n,o){return e.index=o,t+r.call(e,n)}:function(t,r){return t+r},0)},max:function(t,r){return Math.max.apply(null,r?pv.map(t,r):t)}};var MMCQ=function(){var t=5,r=8-t,e=1e3,n=.75;function o(r,e,n){return(r<<2*t)+(e<<t)+n}function i(t){var r=[],e=!1;function n(){r.sort(t),e=!0}return{push:function(t){r.push(t),e=!1},peek:function(t){return e||n(),void 0===t&&(t=r.length-1),r[t]},pop:function(){return e||n(),r.pop()},size:function(){return r.length},map:function(t){return r.map(t)},debug:function(){return e||n(),r}}}function u(t,r,e,n,o,i,u){this.r1=t,this.r2=r,this.g1=e,this.g2=n,this.b1=o,this.b2=i,this.histo=u}function a(){this.vboxes=new i(function(t,r){return pv.naturalOrder(t.vbox.count()*t.vbox.volume(),r.vbox.count()*r.vbox.volume())})}function c(t,r){if(r.count()){var e=r.r2-r.r1+1,n=r.g2-r.g1+1,i=r.b2-r.b1+1,u=pv.max([e,n,i]);if(1==r.count())return[r.copy()];var a,c,s,h,f=0,l=[],p=[];if(u==e)for(a=r.r1;a<=r.r2;a++){for(h=0,c=r.g1;c<=r.g2;c++)for(s=r.b1;s<=r.b2;s++)h+=t[o(a,c,s)]||0;f+=h,l[a]=f}else if(u==n)for(a=r.g1;a<=r.g2;a++){for(h=0,c=r.r1;c<=r.r2;c++)for(s=r.b1;s<=r.b2;s++)h+=t[o(c,a,s)]||0;f+=h,l[a]=f}else for(a=r.b1;a<=r.b2;a++){for(h=0,c=r.r1;c<=r.r2;c++)for(s=r.g1;s<=r.g2;s++)h+=t[o(c,s,a)]||0;f+=h,l[a]=f}return l.forEach(function(t,r){p[r]=f-t}),v(u==e?"r":u==n?"g":"b")}function v(t){var e,n,o,i,u,c=t+"1",s=t+"2",h=0;for(a=r[c];a<=r[s];a++)if(l[a]>f/2){for(o=r.copy(),i=r.copy(),u=(e=a-r[c])<=(n=r[s]-a)?Math.min(r[s]-1,~~(a+n/2)):Math.max(r[c],~~(a-1-e/2));!l[u];)u++;for(h=p[u];!h&&l[u-1];)h=p[--u];return o[s]=u,i[c]=o[s]+1,[o,i]}}}return u.prototype={volume:function(t){return this._volume&&!t||(this._volume=(this.r2-this.r1+1)*(this.g2-this.g1+1)*(this.b2-this.b1+1)),this._volume},count:function(t){var r=this.histo;if(!this._count_set||t){var e,n,i,u=0;for(e=this.r1;e<=this.r2;e++)for(n=this.g1;n<=this.g2;n++)for(i=this.b1;i<=this.b2;i++)u+=r[o(e,n,i)]||0;this._count=u,this._count_set=!0}return this._count},copy:function(){return new u(this.r1,this.r2,this.g1,this.g2,this.b1,this.b2,this.histo)},avg:function(r){var e=this.histo;if(!this._avg||r){var n,i,u,a,c=0,s=1<<8-t,h=0,f=0,l=0;for(i=this.r1;i<=this.r2;i++)for(u=this.g1;u<=this.g2;u++)for(a=this.b1;a<=this.b2;a++)c+=n=e[o(i,u,a)]||0,h+=n*(i+.5)*s,f+=n*(u+.5)*s,l+=n*(a+.5)*s;this._avg=c?[~~(h/c),~~(f/c),~~(l/c)]:[~~(s*(this.r1+this.r2+1)/2),~~(s*(this.g1+this.g2+1)/2),~~(s*(this.b1+this.b2+1)/2)]}return this._avg},contains:function(t){var e=t[0]>>r;return gval=t[1]>>r,bval=t[2]>>r,e>=this.r1&&e<=this.r2&&gval>=this.g1&&gval<=this.g2&&bval>=this.b1&&bval<=this.b2}},a.prototype={push:function(t){this.vboxes.push({vbox:t,color:t.avg()})},palette:function(){return this.vboxes.map(function(t){return t.color})},size:function(){return this.vboxes.size()},map:function(t){for(var r=this.vboxes,e=0;e<r.size();e++)if(r.peek(e).vbox.contains(t))return r.peek(e).color;return this.nearest(t)},nearest:function(t){for(var r,e,n,o=this.vboxes,i=0;i<o.size();i++)((e=Math.sqrt(Math.pow(t[0]-o.peek(i).color[0],2)+Math.pow(t[1]-o.peek(i).color[1],2)+Math.pow(t[2]-o.peek(i).color[2],2)))<r||void 0===r)&&(r=e,n=o.peek(i).color);return n},forcebw:function(){var t=this.vboxes;t.sort(function(t,r){return pv.naturalOrder(pv.sum(t.color),pv.sum(r.color))});var r=t[0].color;r[0]<5&&r[1]<5&&r[2]<5&&(t[0].color=[0,0,0]);var e=t.length-1,n=t[e].color;n[0]>251&&n[1]>251&&n[2]>251&&(t[e].color=[255,255,255])}},{quantize:function(s,h){if(!s.length||h<2||h>256)return!1;var f=function(e){var n,i,u,a,c=new Array(1<<3*t);return e.forEach(function(t){i=t[0]>>r,u=t[1]>>r,a=t[2]>>r,n=o(i,u,a),c[n]=(c[n]||0)+1}),c}(s);f.forEach(function(){});var l=function(t,e){var n,o,i,a=1e6,c=0,s=1e6,h=0,f=1e6,l=0;return t.forEach(function(t){n=t[0]>>r,o=t[1]>>r,i=t[2]>>r,n<a?a=n:n>c&&(c=n),o<s?s=o:o>h&&(h=o),i<f?f=i:i>l&&(l=i)}),new u(a,c,s,h,f,l,e)}(s,f),p=new i(function(t,r){return pv.naturalOrder(t.count(),r.count())});function v(t,r){for(var n,o=1,i=0;i<e;)if((n=t.pop()).count()){var u=c(f,n),a=u[0],s=u[1];if(!a)return;if(t.push(a),s&&(t.push(s),o++),o>=r)return;if(i++>e)return}else t.push(n),i++}p.push(l),v(p,n*h);for(var g=new i(function(t,r){return pv.naturalOrder(t.count()*t.volume(),r.count()*r.volume())});p.size();)g.push(p.pop());v(g,h-g.size());for(var d=new a;g.size();)d.push(g.pop());return d}}}();