function addImage(e,t){var a=document.createElement("div");a.className="row",a.innerHTML='<div class="cell image" style="padding-right:5px;">  <img /></div><div class="cell color"></div>';var n=window.URL||window.webkitURL,l=a.querySelector("img");l.src=n.createObjectURL(e),l.onload=function(){var n=(f=document.createElement("canvas")).getContext("2d"),r=f.width=l.naturalWidth,i=f.height=l.naturalHeight;n.drawImage(l,0,0);var o=n.getImageData(0,0,r,i),c=o.data;o=null,n=null,f=null;var d=a.querySelector(".color"),s=document.createElement("img");s.setAttribute("style","width:100%;"),d.appendChild(s);var u="azer-io-histogram.jpg";void 0!==e.name&&e.name.length>0&&(u=e.name.replace(".jpg").replace(".JPG").replace(".jpeg").replace(".png").replace(".PNG")+"_azer_histogram.jpg");var m=document.createElement("a");m.setAttribute("download",u),m.setAttribute("class","btn btn-primary"),m.textContent="Download";var g=document.createElement("div");g.setAttribute("style","width:100%; text-align:right;"),g.appendChild(m),d.appendChild(g);var f;n=(f=document.createElement("canvas")).getContext("2d");f.width=400,f.height=200,AZR.histogram.build(c,n,f.width,f.height,t),s.src=f.toDataURL("image/jpeg",.8),m.href=s.src,f=null,n=null},document.getElementById("images").appendChild(a)}function handleImages(e){document.getElementById("images").innerHTML="";for(var t=0;t<e.length;t++)addImage(e[t],AZR.cur)}void 0===window.AZR&&(window.AZR={}),AZR.histogram={build:function(e,t,a,n,l){l=l||"red";for(var r=a*n*4,i=Array(256),o=0;o<256;o++)i[o]=0;switch(l){case"red":var c=function(t){return e[t+0]},d="#FF5E5E",s="#FFDFDF";break;case"green":c=function(t){return e[t+1]},d="#83CF4C",s="#E0FFC9";break;case"blue":c=function(t){return e[t+2]},d="#3888FF",s="#C9DFFF";break;case"luminosity":c=function(t){return Math.round(.299*e[t+0]+.587*e[t+1]+.114*e[t+2])},d="#9C9C9C",s="#EFEFEF";break;default:return}for(o=0;o<r;o+=4)i[c(o)]++;var u=Math.max.apply(null,i);i=i.map(function(e){return e/u});scaleX=380/256,scaleY=180,t.fillStyle="#FFFFFF",t.fillRect(0,0,400,200),t.beginPath(),t.moveTo(10,190);for(o=0;o<256;o++)valor=i[o],t.lineTo(o*scaleX+10,180-valor*scaleY+10);t.lineTo(o*scaleX+10,190),t.closePath(),t.fillStyle=s,t.fill(),t.beginPath(),t.lineCap="round",t.lineJoin="round",t.lineWidth=1,t.strokeStyle=d;for(o=0;o<256;o++)valor=i[o],0==o?t.moveTo(10,180-valor*scaleY+10):t.lineTo(o*scaleX+10,180-valor*scaleY+10);t.lineTo(o*scaleX+10,190),t.stroke()}},AZR.cur="red",AZR.changeCur=function(e,t){AZR.cur=t;var a=document.getElementsByClassName("tablinks");for(i=0;i<a.length;i++)a[i].className=a[i].className.replace(" active","");e.className+=" active",null!==window.currfiles&&handleImages(window.currfiles)},window.curfiles=null,document.ondragover=function(e){e.preventDefault(),e.dataTransfer.dropEffect="copy"},document.ondrop=function(e){e.preventDefault(),window.currfiles=e.dataTransfer.files,handleImages(e.dataTransfer.files)},function(){var e=document.getElementById("upload"),t=document.getElementById("target");e.onchange=function(){window.currfiles=this.files,handleImages(this.files)},t.onclick=function(){e.click()}}();